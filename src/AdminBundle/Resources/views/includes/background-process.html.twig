<style>
#bg-monitor {
    position: fixed;
    bottom: 2px;  /* tight against screen bottom */
    right: 20px;   /* tight against screen right */
    z-index: 99999;
    font-family: system-ui, sans-serif;
    user-select: none;
}

#bg-toggle {
    width: 43px;
    height: 38px;
    background: #2e2e2e;
    color: #fff;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    opacity: 0.9;
    transition: all 0.2s ease;
    font-size: 14px;
}

#bg-toggle:hover {
    opacity: 1;
    background: #444;
}

#bg-popup {
    display: none;
    position: absolute;
    bottom: 44px;  /* just above the icon */
    right: 0;
    width: 260px;
    background: #1e1e1e;
    color: #e0e0e0;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    padding: 10px;
    font-size: 13px;
}

#bg-popup h4 {
    margin: 0 0 6px;
    font-size: 13px;
    font-weight: 600;
    border-bottom: 1px solid #333;
    padding-bottom: 4px;
    color: #f5f5f5;
}

#bg-popup ul {
    list-style: none;
    margin: 0;
    padding: 0;
}

#bg-popup li {
    padding: 2px 0;
}
</style>

<div id="bg-monitor">
    <div id="bg-toggle" title="Background Processes"><i class="ti ti-align-box-left-middle"></i></div>
    <div id="bg-popup">
        <h4>Actionable Items</h4>
        <ul id="bg-list">
            <li>No background tasks running</li>
        </ul>
    </div>
</div>

<script defer>
document.addEventListener('DOMContentLoaded', () => {
    const toggle = document.getElementById('bg-toggle');
    const popup = document.getElementById('bg-popup');
    const list = document.getElementById('bg-list');

    // Toggle popup visibility
    toggle.addEventListener('click', () => {
        const isOpen = popup.style.display === 'block';
        popup.style.display = isOpen ? 'none' : 'block';
    });

    // Update list dynamically
    function updateTasks(tasks) {
        list.innerHTML = '';
        if (!tasks.length) {
            list.innerHTML = '<li>No background tasks running</li>';
            return;
        }

        tasks.forEach(task => {
            const li = document.createElement('li');
            li.innerHTML = `<a class="text-white" href="/matchday/event/create/nsl_2025_2026">${task.name}</a>`;
            list.appendChild(li);
        });
    }

    // Demo data
    let demoTasks = [
        { name: 'Click to create Next Away Game Fixture', },
    ];
    updateTasks(demoTasks);

    // Example backend refresh
    // setInterval(async () => {
    //     const response = await fetch('/api/tasks/status');
    //     const data = await response.json();
    //     updateTasks(data);
    // }, 10000);
});
</script>

